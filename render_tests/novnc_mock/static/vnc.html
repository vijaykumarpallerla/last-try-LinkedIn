<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>noVNC Mock</title>
  <style>body{font-family:Arial;margin:20px} #log{border:1px solid #ddd;padding:8px;height:300px;overflow:auto;background:#f8f8f8}</style>
</head>
<body>
  <h3>noVNC Mock Client</h3>
  <div id="log">Not connected</div>
  <div style="margin-top:8px"><input id="inp" placeholder="Message" /><button id="send">Send</button></div>
  <script>
    const scheme = (location.protocol === 'https:') ? 'wss' : 'ws';
    // Default host/port, can use query params to override
    const params = new URLSearchParams(location.search);
    const host = params.get('host') || '127.0.0.1';
    const port = params.get('port') || '6902';
    const wsUrl = `${scheme}://${host}:${port}/`;
    const log = document.getElementById('log');
    let ws;
    function append(x){ log.innerHTML += '<div>'+x+'</div>'; log.scrollTop = log.scrollHeight; }
    try {
      ws = new WebSocket(wsUrl);
      ws.onopen = () => append('WS open to '+wsUrl);
      ws.onmessage = (e) => append('RECV: '+e.data);
      ws.onclose = () => append('WS closed');
      ws.onerror = (e) => append('WS error');
    } catch(e){ append('WS init failed: '+e); }
    document.getElementById('send').onclick = ()=>{
      const v = document.getElementById('inp').value;
      if(!ws || ws.readyState !== WebSocket.OPEN){ append('WS not open'); return; }
      append('SEND: '+v);
      ws.send(v);
    }
  </script>
</body>
</html>
